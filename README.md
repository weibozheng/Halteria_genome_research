# Halteria genome research
## Bioinformatics tools used in Halteria genome research.  
## Usage of all python (or perl) scripts:  
### (1) Code S1. simulation_binomial_sampling.py  
This is a python script. This script can do the simulation of binomial sampling of sequencing reads.  
**Required module:** No additional python module is required.  
**Usage:** python simulation_binomial_sampling.py \<input file: table recording pool population data\> \<output file\> \<total reads number\>   
  **Eg.** python simulation_biomial_sampling.py pol_data.tab output_data.tab 186978547  
The input file is a file in table format. Format is shown below.  

|chromosome|position|minor_allele|MAF|major_allele|MAAF|position_type|poly_type|reads_num|gene|
|---|---|---|---|---|---|---|---|---|---|
|NODE_5302_length_4220_cov_357.479|30|T|0.264044943820225|A|0.69873595505618|inter_genic|bi|1424|NULL|  

### (2) Code S2. ADFinder_singleT.py  
This is a unpublished software. For detailed information, please see this URL "https://github.com/weibozheng/ADFinder"  

### (3) Code S3. blast_xml_protein_coding_sequence_extract_v2.pl  
This is a perl script. This script will extract genes from blast XML file (genome blastx against swiss prot or nr).  
**Required module:** Bio::SeqIO, Bio::SearchIO. They are in the bioperl bundle (version 1.6).  
**Usage:** perl blast_xml_protein_coding_sequence_extract_v2.pl \<contig file: genome assembly\> \<XML file: genome assembly blastx nr or swiss prot database, generated by blastx software (ncbiblast++) using -outfmt 5\> \<output folder\>   
  **Eg.** perl blast_xml_protein_coding_sequence_extract_v2.pl genome.fa genome_blastx_swiss.xml output_folder  
  
### (4) Code S4. entrez_information_extract.pl  
This is a perl script. This script will automatically download detailed information (like function description) of genes from NCBI. Annotated GI number of each gene (acquired using Code S3) is required.    
**Required module:** No additional perl modules is required.  
**Usage:** perl entrez_information_extract.pl \<input file: table-like file that records gene id and GI number of each gene\> \<output file\>   
  **Eg.** perl entrez_information_extract.pl gene_id.tab output.tab   
The input file is a file in table format. Format is shown below.

|gene_id|GI_number|
|---|---|
|gene_1|55976720|
|gene_2|122142798|
  
### (5) Code S5. gff_analysis.pl  
This is a perl script. This script extracts genes and proteins from GFF3 file of produced by AUGUSTUS software.  
**Required module:** Bio::SeqIO. This module is in the bioperl bundle (version 1.6).  
**Usage:** perl gff_analysis.pl \<gff3 file produced by augustus software\> \<genome assembly\> \<output folder\>   
  **Eg.** perl gff_analysis.pl annotation.gff3 genome.fasta output_folder   
    
### (6) Code S6. combine_database_and_denovo_annotation.pl 
This is a perl script. This script will compare genes annotated by database method and de novo method (AUGUSTUS) and remove redundant genes in the final output file.  
**Required module:** Bio::SeqIO. These modules are in the bioperl bundle (version 1.6).  
**Usage:** combine_database_and_denovo_annotation.pl \<genes predicted by database\> \<genes predicted by AUGUSTUS\> \<output folder\>   
  **Eg.** perl combine_database_and_denovo_annotation.pl genes_swiss_prot.fasta genes_denovo.fasta output_folder  
  
### (7) Code S7. pool_population_analysis.pl 
This is a perl script. This script utlizes pool population profile and annotation file (GFF3 format) to analyze each genomic site. 
**Required module:** Bio::SeqIO. These modules are in the bioperl bundle (version 1.6).  
**Usage:** pool_population_analysis.pl \<gff annotation file\> \<pool population profile\> \<output file\>   
  **Eg.** perl pool_population_analysis.pl annotation.gff3 genome.profile output_folder  
The format of pool population profile is shown below.

>contig_id
position A C G T
>contig_1
3 52 22 0 0
5 223 2 0 0
12 0 23 0 29
  
### (8) Code S8. get_trans_ini_termi.pl 
This is a perl script. This script will analyze SAM file generated by bowtie2 or bwa (RNA-seq reads align with genome datasets), and it can predict the boundary of transcription (transcription start and end).  
**Required module:** Bio::SeqIO. This modules is in the bioperl bundle (version 1.6).  
**Usage:** get_trans_ini_termi.pl \<sorted SAM file\> \<genome fasta file\> \<output folder\>   
  **Eg.** perl get_trans_ini_termi.pl RNA_bowtie2_genome.sam genes_denovo.fasta output_folder  
